import{_ as s,o as a,c as n,U as l}from"./chunks/framework.adbdbaa5.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"articles/Other/gcc-warning.md","filePath":"articles/Other/gcc-warning.md"}'),o={name:"articles/Other/gcc-warning.md"},p=l(`<h2 id="gcc警告选项" tabindex="-1">GCC警告选项 <a class="header-anchor" href="#gcc警告选项" aria-label="Permalink to &quot;GCC警告选项&quot;">​</a></h2><h4 id="概-述" tabindex="-1">概 述 <a class="header-anchor" href="#概-述" aria-label="Permalink to &quot;概 述&quot;">​</a></h4><p>在使用GCC编译时，一般会使用<code>-Wall</code>来开启警告，这可以帮助我们找到代码中有问题的结构。 <code>-Wall</code>包含了很多警告标志，在编译时可以直接使用<code>-Wall</code>开启全部，也可以根据自己的需要开启不同的警告级别。本文介绍一些<code>-Wall</code>中常用的警告标志。</p><h4 id="警告标志" tabindex="-1">警告标志 <a class="header-anchor" href="#警告标志" aria-label="Permalink to &quot;警告标志&quot;">​</a></h4><p><strong>-Waddress</strong><code>-Waddress</code>用于警告地址表达式的可疑用法。包括：</p><ul><li>判断函数或声明对象的地址为空</li><li>将指针与字符串进行比较</li><li>对指针进行加法或减法的结果判断为空</li></ul><p><strong>-Wparentheses</strong><code>-Wparentheses</code>用于警告在某些上下文中省略了括号。例如在<code>if()</code>中赋值</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Bad</span></span>
<span class="line"><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Foo</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0x99</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><strong>-Wreturn-type</strong><code>-Wreturn-type</code>用于警告有返回值的函数缺少返回值语句，例如</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Bad</span></span>
<span class="line"><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Foo</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">bar</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bar </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bar </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><strong>-Wuninitialized</strong><code>-Wuninitialized</code>用于警告使用了未初始化的对象，例如</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Bad </span></span>
<span class="line"><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Foo</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> foo</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">Bar</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">        foo </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">Foobar</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">foo</span><span style="color:#89DDFF;">);</span><span style="color:#676E95;font-style:italic;"> // foo可能没有初始化 </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="使-用" tabindex="-1">使 用 <a class="header-anchor" href="#使-用" aria-label="Permalink to &quot;使 用&quot;">​</a></h4><p><code>-Wall</code>警告选项可以与<code>-Werror</code>一同使用，<code>-Werror</code>用于把所有警告都变成错误。</p><p><strong>GCC</strong> 如果使用gcc编译，直接添加<code>-Wall</code>选项或根据需求选择需要的警告标志，例如</p><div class="language-ruby"><button title="Copy Code" class="copy"></button><span class="lang">ruby</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">$ gcc </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wall </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Werror demo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">c </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">o demo</span></span>
<span class="line"><span style="color:#A6ACCD;">$ gcc </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Waddress </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wuninitialized </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wreturn</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">type </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Werror demo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">c </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">o demo</span></span></code></pre></div><p><em>注：对于gcc编译C++报错未定义的引用，应使用<code>g++</code>或<code>-lstdc++</code>，例如</em></p><div class="language-ruby"><button title="Copy Code" class="copy"></button><span class="lang">ruby</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">$ g</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;"> demo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">cpp </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">o demo</span></span>
<span class="line"><span style="color:#A6ACCD;">$ gcc demo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">cpp </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">o demo </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">lstdc</span><span style="color:#89DDFF;">++</span></span></code></pre></div><p><strong>CMake</strong> 如果使用CMake文件编译，使用<code>set()</code>设置编译选项</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CMAKE_C_FLAGS</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-Wall -Werror</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">  //C</span></span>
<span class="line"><span style="color:#82AAFF;">set</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CMAKE_CXX_FLAGS</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-Wall -Werror</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#676E95;font-style:italic;">  //C++</span></span></code></pre></div><hr><p><strong>2022.11.18 补充</strong></p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">variable：不显示未使用的变量告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">parameter：不显示未使用的参数告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">function：不显示未使用的函数告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">but</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">set</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">variable：不显示已赋值但未使用的变量告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">private</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">field：不显示未使用的类私有成员告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unused</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">label：不显示未使用的跳转标记告警</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Wno</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">deprecated：不要警告使用已弃用的功能</span></span></code></pre></div>`,23),e=[p];function t(c,r,D,y,F,C){return a(),n("div",null,e)}const d=s(o,[["render",t]]);export{i as __pageData,d as default};
